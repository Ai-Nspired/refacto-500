<!DOCTYPE html>
<html>
<head>
    <title>HTML Snippet Extractor - Enhanced</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f8f8f8;
        }
        .container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            max-width: 1400px;
            margin: 0 auto;
        }
        textarea, .preview-container, .snippet-container {
            min-height: 500px;
            border: 2px solid #9a2a2a;
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        textarea {
            width: 100%;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            resize: vertical;
        }
        button {
            background: #9a2a2a;
            color: white;
            border: none;
            padding: 10px 16px;
            margin: 5px;
            cursor: pointer;
            border-radius: 5px;
            font-size: 14px;
            transition: background-color 0.3s;
        }
        button:hover {
            background: #7a1a1a;
        }
        button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        .button-group {
            margin: 10px 0;
        }
        iframe {
            width: 100%;
            height: 100%;
            border: none;
            background: white;
            border-radius: 4px;
        }
        pre {
            margin: 0;
            overflow-x: auto;
            background: #f4f4f4;
            padding: 15px;
            border-radius: 4px;
            font-size: 13px;
        }
        .tab-buttons {
            display: flex;
            margin-bottom: 10px;
        }
        .tab-buttons button {
            background: #ddd;
            color: black;
            border-radius: 5px 5px 0 0;
        }
        .tab-buttons button.active {
            background: #9a2a2a;
            color: white;
        }
        .analysis-section {
            background: #f9f9f9;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 15px;
            border-left: 4px solid #9a2a2a;
        }
        .analysis-item {
            margin: 8px 0;
            display: flex;
            justify-content: space-between;
        }
        .analysis-item strong {
            color: #9a2a2a;
        }
        .snippet-controls {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }
        select {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }
        .status-message {
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
            display: none;
        }
        .status-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .status-error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .hljs {
            background: #f8f8f8 !important;
        }
    </style>
</head>
<body>
    <div class="container">
        <div>
            <h2>Input HTML</h2>
            <textarea id="html-input" placeholder="Paste your complete HTML here..."></textarea>
            <div class="button-group">
                <button id="preview-btn">Preview & Analyze</button>
                <button id="clear-btn">Clear</button>
            </div>
            <div id="status-message" class="status-message"></div>
        </div>

        <div>
            <div class="tab-buttons">
                <button class="active" data-tab="preview">Preview</button>
                <button data-tab="analysis">Analysis</button>
                <button data-tab="snippets">Snippets</button>
            </div>
            
            <div class="preview-container" id="preview-tab">
                <iframe id="preview-frame"></iframe>
            </div>
            
            <div class="snippet-container" id="analysis-tab" style="display:none;">
                <h3>HTML Structure Analysis</h3>
                <div id="analysis-results">
                    <p>Click "Preview & Analyze" to see detailed analysis of your HTML structure.</p>
                </div>
            </div>
            
            <div class="snippet-container" id="snippets-tab" style="display:none;">
                <h3>Extract Code Snippets</h3>
                <div class="snippet-controls">
                    <select id="snippet-type">
                        <option value="full">Full Page</option>
                        <option value="head">Head Section</option>
                        <option value="styles">All Styles</option>
                        <option value="scripts">All Scripts</option>
                        <option value="nav">Navigation Elements</option>
                        <option value="header">Header Section</option>
                        <option value="main">Main Content</option>
                        <option value="footer">Footer Section</option>
                        <option value="forms">Form Elements</option>
                        <option value="tables">Table Elements</option>
                        <option value="lists">List Elements</option>
                        <option value="images">Image Elements</option>
                        <option value="links">Link Elements</option>
                    </select>
                    <button id="generate-snippet">Generate</button>
                    <button id="copy-snippet">Copy</button>
                </div>
                <pre id="snippet-output"><code>// Select a component type and click Generate</code></pre>
            </div>
        </div>
    </div>

    <script>
        let currentHTML = '';
        let parsedDocument = null;

        // Tab switching functionality
        document.querySelectorAll('.tab-buttons button').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.tab-buttons button').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                
                // Hide all tabs
                document.getElementById('preview-tab').style.display = 'none';
                document.getElementById('analysis-tab').style.display = 'none';
                document.getElementById('snippets-tab').style.display = 'none';
                
                // Show selected tab
                document.getElementById(btn.dataset.tab + '-tab').style.display = 'block';
            });
        });

        // Show status message
        function showStatus(message, type = 'success') {
            const statusEl = document.getElementById('status-message');
            statusEl.textContent = message;
            statusEl.className = `status-message status-${type}`;
            statusEl.style.display = 'block';
            setTimeout(() => {
                statusEl.style.display = 'none';
            }, 3000);
        }

        // Analyze HTML structure
        function analyzeHTML(html) {
            try {
                const parser = new DOMParser();
                const doc = parser.parseFromString(html, 'text/html');
                parsedDocument = doc;
                
                const analysis = {
                    totalElements: doc.querySelectorAll('*').length,
                    headElements: doc.querySelectorAll('head *').length,
                    bodyElements: doc.querySelectorAll('body *').length,
                    divElements: doc.querySelectorAll('div').length,
                    spanElements: doc.querySelectorAll('span').length,
                    paragraphs: doc.querySelectorAll('p').length,
                    headings: doc.querySelectorAll('h1, h2, h3, h4, h5, h6').length,
                    links: doc.querySelectorAll('a').length,
                    images: doc.querySelectorAll('img').length,
                    forms: doc.querySelectorAll('form').length,
                    inputs: doc.querySelectorAll('input, textarea, select').length,
                    tables: doc.querySelectorAll('table').length,
                    lists: doc.querySelectorAll('ul, ol').length,
                    scripts: doc.querySelectorAll('script').length,
                    styles: doc.querySelectorAll('style, link[rel="stylesheet"]').length,
                    classes: new Set(Array.from(doc.querySelectorAll('[class]')).map(el => el.className.split(' ')).flat().filter(c => c.trim())).size,
                    ids: doc.querySelectorAll('[id]').length
                };

                // Display analysis results
                const resultsContainer = document.getElementById('analysis-results');
                resultsContainer.innerHTML = `
                    <div class="analysis-section">
                        <h4>Element Count</h4>
                        <div class="analysis-item"><span>Total Elements:</span> <strong>${analysis.totalElements}</strong></div>
                        <div class="analysis-item"><span>Head Elements:</span> <strong>${analysis.headElements}</strong></div>
                        <div class="analysis-item"><span>Body Elements:</span> <strong>${analysis.bodyElements}</strong></div>
                    </div>
                    
                    <div class="analysis-section">
                        <h4>Content Elements</h4>
                        <div class="analysis-item"><span>Div Elements:</span> <strong>${analysis.divElements}</strong></div>
                        <div class="analysis-item"><span>Span Elements:</span> <strong>${analysis.spanElements}</strong></div>
                        <div class="analysis-item"><span>Paragraphs:</span> <strong>${analysis.paragraphs}</strong></div>
                        <div class="analysis-item"><span>Headings:</span> <strong>${analysis.headings}</strong></div>
                    </div>
                    
                    <div class="analysis-section">
                        <h4>Interactive Elements</h4>
                        <div class="analysis-item"><span>Links:</span> <strong>${analysis.links}</strong></div>
                        <div class="analysis-item"><span>Images:</span> <strong>${analysis.images}</strong></div>
                        <div class="analysis-item"><span>Forms:</span> <strong>${analysis.forms}</strong></div>
                        <div class="analysis-item"><span>Input Fields:</span> <strong>${analysis.inputs}</strong></div>
                    </div>
                    
                    <div class="analysis-section">
                        <h4>Structure Elements</h4>
                        <div class="analysis-item"><span>Tables:</span> <strong>${analysis.tables}</strong></div>
                        <div class="analysis-item"><span>Lists:</span> <strong>${analysis.lists}</strong></div>
                        <div class="analysis-item"><span>Scripts:</span> <strong>${analysis.scripts}</strong></div>
                        <div class="analysis-item"><span>Styles:</span> <strong>${analysis.styles}</strong></div>
                    </div>
                    
                    <div class="analysis-section">
                        <h4>Attributes</h4>
                        <div class="analysis-item"><span>Unique Classes:</span> <strong>${analysis.classes}</strong></div>
                        <div class="analysis-item"><span>Elements with IDs:</span> <strong>${analysis.ids}</strong></div>
                    </div>
                `;

                return analysis;
            } catch (error) {
                console.error('Analysis error:', error);
                document.getElementById('analysis-results').innerHTML = `
                    <div class="analysis-section">
                        <h4>Analysis Error</h4>
                        <p style="color: #721c24;">Could not analyze HTML: ${error.message}</p>
                    </div>
                `;
                return null;
            }
        }

        // Preview and analyze button
        document.getElementById('preview-btn').addEventListener('click', function() {
            const html = document.getElementById('html-input').value;
            if (!html.trim()) {
                showStatus("Please enter HTML content", "error");
                return;
            }
            
            currentHTML = html;
            
            // Create preview
            const iframe = document.getElementById('preview-frame');
            const blob = new Blob([html], {type: 'text/html'});
            iframe.src = URL.createObjectURL(blob);
            
            // Perform analysis
            analyzeHTML(html);
            
            // Show success message
            showStatus("HTML previewed and analyzed successfully!");
            
            // Enable other tabs
            iframe.onload = function() {
                document.querySelector('[data-tab="analysis"]').disabled = false;
                document.querySelector('[data-tab="snippets"]').disabled = false;
            };
        });

        // Clear button
        document.getElementById('clear-btn').addEventListener('click', function() {
            document.getElementById('html-input').value = '';
            document.getElementById('preview-frame').src = '';
            document.getElementById('analysis-results').innerHTML = '<p>Click "Preview & Analyze" to see detailed analysis of your HTML structure.</p>';
            document.getElementById('snippet-output').innerHTML = '<code>// Select a component type and click Generate</code>';
            currentHTML = '';
            parsedDocument = null;
            showStatus("Content cleared");
        });

        // Enhanced snippet generation
        document.getElementById('generate-snippet').addEventListener('click', function() {
            if (!currentHTML || !parsedDocument) {
                showStatus("Please preview and analyze HTML first", "error");
                return;
            }
            
            const type = document.getElementById('snippet-type').value;
            
            try {
                let snippet = '';
                let elements = [];
                
                switch(type) {
                    case 'full':
                        snippet = currentHTML;
                        break;
                        
                    case 'head':
                        const head = parsedDocument.querySelector('head');
                        snippet = head ? head.outerHTML : '<!-- No head section found -->';
                        break;
                        
                    case 'styles':
                        elements = Array.from(parsedDocument.querySelectorAll('style, link[rel="stylesheet"]'));
                        snippet = elements.length > 0 ? 
                            elements.map(el => el.outerHTML).join('\n\n') : 
                            '<!-- No styles found -->';
                        break;
                        
                    case 'scripts':
                        elements = Array.from(parsedDocument.querySelectorAll('script'));
                        snippet = elements.length > 0 ? 
                            elements.map(el => el.outerHTML).join('\n\n') : 
                            '<!-- No scripts found -->';
                        break;
                        
                    case 'nav':
                        elements = Array.from(parsedDocument.querySelectorAll('nav, .nav, .navigation, .navbar'));
                        snippet = elements.length > 0 ? 
                            elements.map(el => el.outerHTML).join('\n\n') : 
                            '<!-- No navigation elements found -->';
                        break;
                        
                    case 'header':
                        elements = Array.from(parsedDocument.querySelectorAll('header, .header'));
                        snippet = elements.length > 0 ? 
                            elements.map(el => el.outerHTML).join('\n\n') : 
                            '<!-- No header elements found -->';
                        break;
                        
                    case 'main':
                        elements = Array.from(parsedDocument.querySelectorAll('main, .main, .content, .main-content'));
                        snippet = elements.length > 0 ? 
                            elements.map(el => el.outerHTML).join('\n\n') : 
                            '<!-- No main content elements found -->';
                        break;
                        
                    case 'footer':
                        elements = Array.from(parsedDocument.querySelectorAll('footer, .footer'));
                        snippet = elements.length > 0 ? 
                            elements.map(el => el.outerHTML).join('\n\n') : 
                            '<!-- No footer elements found -->';
                        break;
                        
                    case 'forms':
                        elements = Array.from(parsedDocument.querySelectorAll('form'));
                        snippet = elements.length > 0 ? 
                            elements.map(el => el.outerHTML).join('\n\n') : 
                            '<!-- No forms found -->';
                        break;
                        
                    case 'tables':
                        elements = Array.from(parsedDocument.querySelectorAll('table'));
                        snippet = elements.length > 0 ? 
                            elements.map(el => el.outerHTML).join('\n\n') : 
                            '<!-- No tables found -->';
                        break;
                        
                    case 'lists':
                        elements = Array.from(parsedDocument.querySelectorAll('ul, ol'));
                        snippet = elements.length > 0 ? 
                            elements.map(el => el.outerHTML).join('\n\n') : 
                            '<!-- No lists found -->';
                        break;
                        
                    case 'images':
                        elements = Array.from(parsedDocument.querySelectorAll('img'));
                        snippet = elements.length > 0 ? 
                            elements.map(el => el.outerHTML).join('\n') : 
                            '<!-- No images found -->';
                        break;
                        
                    case 'links':
                        elements = Array.from(parsedDocument.querySelectorAll('a'));
                        snippet = elements.length > 0 ? 
                            elements.map(el => el.outerHTML).join('\n') : 
                            '<!-- No links found -->';
                        break;
                }
                
                // Apply syntax highlighting
                const highlighted = hljs.highlight(snippet, {language: 'html'}).value;
                document.getElementById('snippet-output').innerHTML = highlighted;
                
                showStatus(`${type.charAt(0).toUpperCase() + type.slice(1)} snippet generated successfully!`);
                
            } catch (e) {
                document.getElementById('snippet-output').innerHTML = `<code>ERROR: ${e.message}</code>`;
                showStatus(`Error generating snippet: ${e.message}`, "error");
            }
        });

        // Copy snippet functionality
        document.getElementById('copy-snippet').addEventListener('click', function() {
            const snippetElement = document.querySelector('#snippet-output');
            if (!snippetElement || !snippetElement.textContent.trim()) {
                showStatus("No snippet to copy", "error");
                return;
            }
            
            const snippet = snippetElement.textContent;
            navigator.clipboard.writeText(snippet).then(() => {
                showStatus('Snippet copied to clipboard!');
            }).catch(err => {
                showStatus('Failed to copy to clipboard', "error");
                console.error('Copy failed:', err);
            });
        });

        // Initialize highlight.js
        hljs.highlightAll();
    </script>
</body>
</html>
